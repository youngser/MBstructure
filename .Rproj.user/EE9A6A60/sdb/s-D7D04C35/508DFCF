{
    "collab_server" : "",
    "contents" : "---\noutput: \n    html_document:\n      css: ~/RFolder/pandoc.css\n      fig_height: 6\n      fig_width: 6\n      highlight: pygments\n      keep_md: yes\n#        number_sections: yes\n    theme: cerulean\n#        toc: yes\n#        toc_depth: 3\n#        toc_float: no\n---\n\n<style type=\"text/css\">\n.table {\n    width: 40%;\n}\n</style>\n\n```{r setup, include=FALSE, results='asis'}\nlibrary(knitr)\nknitr::opts_chunk$set(echo=TRUE, eval=FALSE,warning=FALSE)\n\nopts_knit$set(aliases=c(h='fig.height', w='fig.width', cap='fig.cap', scap='fig.scap'))                                                                               \nopts_knit$set(eval.after = c('fig.cap','fig.scap'))                                                                            \nknit_hooks$set(document = function(x) {                                                                                        \n          gsub('(\\\\\\\\end\\\\{knitrout\\\\}[\\n]+)', '\\\\1\\\\\\\\noindent ', x)                                                                  \n          })\n\n fn = local({\n   i = 0\n   function(x) {\n     i <<- i + 1\n#     paste('Figure ', i, ': ', x, sep = '')\n     paste('', '', x, sep = '')\n   }\n })\n\n\nsuppressMessages(library(ggplot2))\nsuppressMessages(library(igraph))\nsuppressMessages(library(Matrix))\nsuppressMessages(library(lattice))\nsuppressMessages(library(mclust))\nsuppressMessages(library(RColorBrewer))\nsuppressMessages(library(packcircles))\nsuppressMessages(library(mvtnorm))\nsuppressMessages(library(printr))\nsuppressMessages(library(xtable))\n\n```\n\n## Semiparametric spectral modeling of the Drosophila connectome\n**[Department of Applied Mathematics and Statistics](http://engineering.jhu.edu/ams/)**      \n**[Center for Imaging Science](http://www.cis.jhu.edu)**  \n**[Human Language Technology Center of Excellence](http://hltcoe.jhu.edu)**  \n**[Johns Hopkins University](http://www.jhu.edu)**  \nand  \n**[University of Cincinati](http://business.uc.edu)**  \nand  \n**[HHMI Janelia Research Campus](hhmi.org)**  \n\n-----\n\n> C.E. Priebe,  Y. Park, M. Tang, A, Athreya, V. Lyzinski, J. Vogelstein,\nY. Qin, B. Cocanougher, K. Eichler, M. Zlatic, A. Cardona,\n\"[Semiparametric spectral modeling of the Drosophila connectome](http://arxiv.org/abs/1502.03391),\" _Journal of the American Statistical Association Application and Case Studies_, submmitted, 2017.\n\n\n## Abstract\n\n> We present semiparametric spectral modeling of the complete larval Drosophila mushroom body connectome. The resulting connectome code derived via semiparametric Gaussian mixture mod- eling composed with adjacency spectral embedding captures biologically relevant neuronal prop- erties.\n\n> **Keywords**: Connectome; Network; Graph; Spectral embedding; Mixture model; Clustering\n\n<figure>\n<img src=\"diagram-circuit.jpg\" width=\"700px\" />\n  <figcaption>Illustration of the Drosophila Mushroom Body circuit as a (K = 4)-block directed stochastic block model. This first-order simplification of the structure of the circuit provides a framework for graph embedding inference, and for subsequent Knowledge Base interaction.</figcaption>\n</figure>\n\n## Codes and Experiments\n\nTo run the experiemnts in the paper, please follow these steps:\n\n### The larval _Drosophila_ mushroom body connectome\n\nOutput of this chunk looks like [this](sec2.html).\n\n```{r fig2}\nlibrary(mbstructure)\ndata(MBconnectome)\n\nout <- generate.graph(newrdat, vdf.right)\ng <- out$g\nvdf <- out$vdf\nplotConnections(g, vdf)\n```\n\n### Spectral clustering\n\nOutput of this chunk looks like [this](sec3.html).\n\n```{r fig4}\ndmax <- 50\nXhat <- doEmbed(g, dmax)\n\nKmax <- 19\nmc <- Mclust(Xhat, 1:Kmax)\nvdf$cluster <- factor(mc$class)\nplotBIC(mc)\nplotClustering(Xhat, mc, vdf)\n```\n\n### Semiparametric spectral modeling\n\nOutput of this chunk looks like [this](sec4.html).\n\n```{r semipar}\nsynthMB(g, vdf)\nplotMLE(Xhat, vdf) \n```\n\n```{r etc, eval=FALSE, echo=FALSE}\n### Discussion\n\nA2 <- (g[] + t(g[])) / 2\n```\n\n```{r g-left,eval=FALSE,echo=FALSE}\nout.left <- generate.graph(newldat, vdf.left)\ng.left <- out.left$g\nvdf.left <- out.left$vdf\nplotConnections(g.left, vdf.left)\n```\n\n## `R` Package\n\nThe latest `R` source package can be downloaded from [here](http://www.cis.jhu.edu/~parky/mbstructure_0.1.0.tar.gz).  \nIt can be installed via:\n```{r echo=TRUE,eval=FALSE}\ninstall.packages(\"http://username:password@www.cis.jhu.edu/~parky/MBstructure/mbstructure_0.1.0.tar.gz\",type=\"source\",method=\"wget\")\n```\n```{r vn,echo=TRUE, eval=TRUE}\nlibrary(help='mbstructure')\n```\n\n-----\n*prepared by <youngser@jhu.edu> on `r date()`*\n",
    "created" : 1487595092729.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4198369718",
    "id" : "508DFCF",
    "lastKnownWriteTime" : 1487602809,
    "last_content_update" : 1487602809988,
    "path" : "~/Dropbox/Worm/Codes/Connectome/mbstructure/demo.Rmd",
    "project_path" : "demo.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}